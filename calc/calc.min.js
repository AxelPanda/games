(function(c){var b={};b.util={randInt:function(e,d){return Math.floor(Math.random()*(d-e+1))+e},generateNumbers:function(){return[b.util.randInt(3,9),b.util.randInt(3,14)]},generateDelta:function(){return(b.util.randInt(0,1)*2+1)*(Math.random()<0.5?-1:1)},generateOperator:function(){return Math.random()<0.5?"+":"-"},bindTap:function(f,g){if("ontouchend" in c){var d,e;f.addEventListener("touchstart",function(h){d=h.touches[0];e=h.timestamp});f.addEventListener("touchend",function(i){var h=i.changedTouches[0];if(i.timestamp-e>=400){return}if(Math.max(Math.abs(h.clientX-d.clientX),Math.abs(h.clientY-d.clientY))>10){return}g.call(f,i);i.preventDefault()});f.addEventListener("click",function(h){h.preventDefault()})}else{f.addEventListener("click",function(h){g.call(f,h)})}},show:function(d){d.style.cssText="display: block;"},hide:function(d){d.style.cssText="display: none;"}};b.status=(function(){var d=0;var f=-1;var e=null;return{check:function(){return d===0},getEqual:function(){return e},next:function(){if(d===1){return}b.ui.process.style.cssText="width: 0%;";b.ui.score.innerText=++f;if(f===25||f===50||f===80){b.timer.speedUp()}e=b.process()},end:function(){d=1;b.timer.clearTimer();b.ui.result.innerHTML="<p>游戏结束</p><p>最终得分："+f+"</p>";b.ui.restartBtn.innerText="► 重试";b.share.desc="我得了"+f+"分，你能算得比我快吗？速算小游戏，看谁算得快？";b.util.show(b.ui.mask)},reset:function(){f=-1;b.ui.score.innerText=d=0;b.share.desc="速算小游戏，看谁算得快？";b.util.hide(b.ui.mask);b.status.next()}}})();b.timer=(function(){var e=null;var d=2000;return{speedUp:function(){d/=2},clearTimer:function(){clearTimeout(e)},resetTimer:function(){clearTimeout(e);var f=0;b.ui.process.style.cssText="width: 0%;";e=setInterval(function(){f+=d/10;b.ui.process.style.cssText="width: "+f/d*100+"%;";if(f>=d){b.status.end()}},d/10)}}})();b.process=function(){var d=b.util.generateNumbers();var g=true,i=0;if(Math.random()<0.6){g=false;i=b.util.generateDelta()}var f=b.util.generateOperator();if(f==="+"){d[2]=d[0]+d[1]+i}else{d[2]=d[0];d[0]=d[0]+d[1]+i}var h="";var e=f==="+"?d[0]+" + "+d[1]:d[0]+" - "+d[1];h+=Math.random()<0.5?e+" = "+d[2]:d[2]+" = "+e;b.ui.equation.innerText=h;b.timer.resetTimer();return g};b.share={appId:"",img:location.href.substring(0,location.href.lastIndexOf("/"))+"/calc.png",imgSize:"120",url:location.href,title:"谁算得快？",desc:"速算小游戏，看谁算得快？"};var a=c.document;c.addEventListener("load",function(){b.ui={score:a.getElementById("score"),process:a.getElementById("process"),equation:a.getElementById("equation"),trueBtn:a.getElementById("trueBtn"),falseBtn:a.getElementById("falseBtn"),mask:a.getElementById("mask"),result:a.getElementById("result"),restartBtn:a.getElementById("restartBtn")};b.util.bindTap(b.ui.trueBtn,function(){if(!b.status.check()){return}if(b.status.getEqual()===true){b.status.next()}else{b.status.end()}});b.util.bindTap(b.ui.falseBtn,function(){if(!b.status.check()){return}if(b.status.getEqual()===false){b.status.next()}else{b.status.end()}});b.util.bindTap(b.ui.restartBtn,function(){b.status.reset()})});a.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.on("menu:share:appmessage",function(d){WeixinJSBridge.invoke("sendAppMessage",{appid:b.share.appId,img_url:b.share.img,img_width:b.share.imgSize,img_height:b.share.imgSize,link:b.share.url,desc:b.share.desc,title:b.share.title})});WeixinJSBridge.on("menu:share:timeline",function(d){WeixinJSBridge.invoke("shareTimeline",{img_url:b.share.img,img_width:b.share.imgSize,img_height:b.share.imgSize,link:b.share.url,desc:b.share.desc,title:b.share.desc})})})})(window);