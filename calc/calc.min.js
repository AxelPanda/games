!function(e){var t={};t.util={randInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},generateNumbers:function(){return[t.util.randInt(3,9),t.util.randInt(3,14)]},generateDelta:function(){return(2*t.util.randInt(0,1)+1)*(Math.random()<.5?-1:1)},generateOperator:function(){return Math.random()<.5?"+":"-"},bindTap:function(t,n){if("ontouchend"in e){var i,r;t.addEventListener("touchstart",function(e){i=e.touches[0],r=e.timestamp}),t.addEventListener("touchend",function(e){var s=e.changedTouches[0];e.timestamp-r>=400||Math.max(Math.abs(s.clientX-i.clientX),Math.abs(s.clientY-i.clientY))>10||(n.call(t,e),e.preventDefault())}),t.addEventListener("click",function(e){e.preventDefault()})}else t.addEventListener("click",function(e){n.call(t,e)})},show:function(e){e.style.cssText="display: block;"},hide:function(e){e.style.cssText="display: none;"}},t.status=function(){var e=0,n=-1,i=null;return{check:function(){return 0===e},getEqual:function(){return i},next:function(){1!==e&&(t.ui.process.style.cssText="width: 0%;",t.ui.score.innerText=++n,(25===n||50===n||80===n)&&t.timer.speedUp(),i=t.process())},end:function(){e=1,t.timer.clearTimer(),t.ui.result.innerHTML="<p>游戏结束</p><p>最终得分："+n+"</p>",t.ui.restartBtn.innerText="► 重试",t.share.desc="我得了"+n+"分，你能算得比我快吗？速算小游戏，看谁算得快？",t.util.show(t.ui.mask)},reset:function(){n=-1,t.ui.score.innerText=e=0,t.share.desc="速算小游戏，看谁算得快？",t.util.hide(t.ui.mask),t.status.next()}}}(),t.timer=function(){var e=null,n=2e3;return{speedUp:function(){n/=2},clearTimer:function(){clearTimeout(e)},resetTimer:function(){clearTimeout(e);var i=0;t.ui.process.style.cssText="width: 0%;",e=setInterval(function(){i+=n/10,t.ui.process.style.cssText="width: "+i/n*100+"%;",i>=n&&t.status.end()},n/10)}}}(),t.process=function(){var e=t.util.generateNumbers(),n=!0,i=0;Math.random()<.6&&(n=!1,i=t.util.generateDelta());var r=t.util.generateOperator();"+"===r?e[2]=e[0]+e[1]+i:(e[2]=e[0],e[0]=e[0]+e[1]+i);var s="",a="+"===r?e[0]+" + "+e[1]:e[0]+" - "+e[1];return s+=Math.random()<.5?a+" = "+e[2]:e[2]+" = "+a,t.ui.equation.innerText=s,t.timer.resetTimer(),n},t.share={appId:"",img:location.href.substring(0,location.href.lastIndexOf("/"))+"/calc.png",imgSize:"120",url:location.href,title:"谁算得快？",desc:"速算小游戏，看谁算得快？"};var n=e.document;e.addEventListener("load",function(){t.ui={score:n.getElementById("score"),process:n.getElementById("process"),equation:n.getElementById("equation"),trueBtn:n.getElementById("trueBtn"),falseBtn:n.getElementById("falseBtn"),mask:n.getElementById("mask"),result:n.getElementById("result"),restartBtn:n.getElementById("restartBtn")},t.util.bindTap(t.ui.trueBtn,function(){t.status.check()&&(t.status.getEqual()===!0?t.status.next():t.status.end())}),t.util.bindTap(t.ui.falseBtn,function(){t.status.check()&&(t.status.getEqual()===!1?t.status.next():t.status.end())}),t.util.bindTap(t.ui.restartBtn,function(){t.status.reset()})}),n.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.on("menu:share:appmessage",function(e){WeixinJSBridge.invoke("sendAppMessage",{appid:t.share.appId,img_url:t.share.img,img_width:t.share.imgSize,img_height:t.share.imgSize,link:t.share.url,desc:t.share.desc,title:t.share.title})}),WeixinJSBridge.on("menu:share:timeline",function(e){WeixinJSBridge.invoke("shareTimeline",{img_url:t.share.img,img_width:t.share.imgSize,img_height:t.share.imgSize,link:t.share.url,desc:t.share.desc,title:t.share.title})})})}(window);